<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mk.taskfactory.biz.mapper.RoomSaleConfigMapper">

	<resultMap id="countAgentSpread" type="com.mk.taskfactory.model.TRoomSaleConfig">
	    <result property="id" column="id" />
	    <result property="hotelId" column="hotelId" />
	    <result property="roomId" column="roomId" />
        <result property="roomTypeId" column="roomTypeId" />
        <result property="startTime" column="startTime" />
        <result property="endTime" column="endTime" />
        <result property="startDate" column="startDate" />
        <result property="endDate" column="endDate" />
        <result property="salePrice" column="salePrice" />
        <result property="costPrice" column="costPrice" />
        <result property="markertPrice" column="markertPrice" />
        <result property="num" column="num" />
	</resultMap>

    <sql id="Base_Column_List" >
        id, agentNo, parentId, wxSpreadNum, wxSpreadPrice, appSpreadNum, appSpreadPrice, orderNum, orderPrice, date, month,orderonlineNum,
        orderonlinePrice,orderofflineNum,orderofflinePrice,orderqiekeNum,orderqiekePrice,monthRegisterCount,monthOrdersUserCount
    </sql>

    <sql id="Base_Query_List" >
        <where>
            <if test="id != null">
                 id = #{id}
            </if>
            <if test="agentNo != null">
                AND agentNo = #{agentNo}
            </if>
            <if test="parentId != null">
                AND parentId = #{parentId}
            </if>
            <if test="date != null">
                AND date = #{date}
            </if>
            <if test="parentId != null">
                AND parentId = #{parentId}
            </if>
            <if test="month != null">
                AND month = #{month}
            </if>
        </where>
    </sql>

    <select id="queryCountAgentSpreadByParams" resultMap="countAgentSpread" parameterType="com.mk.taskfactory.api.dtos.CountAgentSpreadDto">
        SELECT
        <include refid="Base_Column_List"/>
         FROM  count_agent_spread
        <include refid="Base_Query_List"/>
    </select>
    <select id="countCountAgentSpreadByParams" resultType="Integer" parameterType="com.mk.taskfactory.api.dtos.CountAgentSpreadDto">
        select count(*) from count_agent_spread
        <include refid="Base_Query_List"/>
    </select>

    <insert id="saveCountAgentSpread"  parameterType="com.mk.taskfactory.api.dtos.CountAgentSpreadDto" >
        INSERT INTO count_agent_spread
        <include refid="Base_Column_List"/>
         VALUE
         (
            #{id},#{agentNo}, #{parentId},#{wxSpreadNum}, #{wxSpreadPrice}, #{appSpreadNum},#{appSpreadPrice}, #{orderNum}, #{date},#{month},
           #{orderonlineNum},  #{orderonlinePrice},  #{orderofflineNum},  #{orderofflinePrice},  #{orderqiekeNum},  #{orderqiekePrice},  #{monthRegisterCount},  #{createTime},
           #{monthOrdersUserCount}
            )
    </insert>


    <delete id="deleteCountAgentSpread" parameterType="Integer">
         delete from count_agent_spread where id = #{id}
    </delete>

    <update id="updateCountAgentSpread" parameterType="com.mk.taskfactory.api.dtos.CountAgentSpreadDto" >
        update count_agent_spread
        set
         id= #{id},
         agentNo = #{agentNo},
         parentId = #{parentId},
         wxSpreadNum =  #{wxSpreadNum},
         wxSpreadPrice =  #{wxSpreadPrice},
         appSpreadNum  = #{appSpreadNum},
         appSpreadPrice =  #{appSpreadPrice},
         orderNum =  #{orderNum},
         orderPrice  = #{orderPrice},
         date  = #{date},
         month =  #{month},
         orderonlineNum =  #{orderonlineNum},
         orderonlinePrice =  #{orderonlinePrice},
         orderofflineNum =  #{orderofflineNum},
         orderofflinePrice =  #{orderofflinePrice},
         orderqiekeNum =  #{orderqiekeNum},
         orderqiekePrice =  #{orderqiekePrice},
         monthRegisterCount =  #{monthRegisterCount},
         monthOrdersUserCount =  #{monthOrdersUserCount}
        where id = #{id}
    </update>

    <select id="getCountAgentSpread" resultMap="countAgentSpread" parameterType="com.mk.taskfactory.api.dtos.CountAgentSpreadDto">
        SELECT
        <include refid="Base_Column_List"/>
        FROM  count_agent_spread
        <include refid="Base_Query_List"/>
        ORDER BY  date DESC limit 1
    </select>
</mapper>
